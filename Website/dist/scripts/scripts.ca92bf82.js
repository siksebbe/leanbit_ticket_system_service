"use strict";function WorkItem(){var a={};return a.name="",a.description="",a.status="",a.priority=0,a.issue=null,a.id=0,a}function WorkItem(a,b,c,d,e,f){var g={};return g.name=a,g.description=b,g.status=c,g.priority=d,g.issue=e,g.id=f,g}angular.module("leanbitSupportTicketSystemApp",["ngAnimate","ngResource","ngRoute","ngSanitize","ngTouch","ui.sortable"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/about",{templateUrl:"views/about.html",controller:"MainCtrl",controllerAs:"main"}).when("/newitem",{templateUrl:"views/newitem.html",controller:"MainCtrl",controllerAs:"main"}).otherwise({redirectTo:"/"})}]),angular.module("leanbitSupportTicketSystemApp").controller("MainCtrl",function(){});var app=angular.module("leanbitSupportTicketSystemApp");app.controller("WorkitemCtrl",["$scope","workitemDb","usersDb",function(a,b,c){function d(a){}function e(){c.getAll().then(function(b){a.users=b.data},d)}function f(){b.getAll().then(function(b){a.workItems=b.data},d)}function g(c){b.update(c),a.update=!1}function h(b){var c={placeholder:"app",connectWith:".apps-container",stop:function(b,c){var d=c.item.parent().attr("id"),e=c.item.attr("id");a.workItems[e].status=d,g(a.workItems[e])}};return c}a.categories=WorkItemCategories,a.users=[],a.work=WorkItem(),a.update,e(),f(),a.getWorkitemUsers=function(b,c){for(var d=[],e=0;e<a.users.length;e++)for(var f in a.users[e].workItems)a.users[e].workItems[f].name===b&&d.push(a.users[e]);return d},a.addNewWorkItemPopup=function(b,c){a.selectedCategory=b,a.update=!1;for(var d=0;d<a.categories.length;d++)if(a.categories[d]==b){var e=document.getElementById("workitemStatusSelection");e.options[d+1].selected=!0}document.getElementById("popup").style.display="block"},a.closeAddNewWorkItemPopup=function(){document.getElementById("popup").style.display="none"},a.modifyWorkItemPopup=function(b){a.update=!0,a.selectedCategory=b.status;for(var c=0;c<a.categories.length;c++)if(a.categories[c]==a.selectedCategory){var d=document.getElementById("workitemStatusSelection");d.options[c+1].selected=!0}for(var e=0,c=0;c<a.users.length;c++)for(var f in a.users[c].workItems)a.users[c].workItems[f].name===name&&(e=c);var d=document.getElementById("useritemUserSelection");d.options[e+1].selected=!0,a.work.name=b.name,document.getElementById("workitemName").value=b.name,a.work.description=b.description,document.getElementById("workitemDescription").value=b.description,a.work.priority=b.priority,document.getElementById("workitemPriority").value=b.priority,document.getElementById("popup").style.display="block"},a.deleteWorkItemButton=function(c){for(var d=0,e=0;e<a.users.length;e++)for(var g in a.users[e].workItems)a.users[e].workItems[g].name===name&&(d=e);a.users[d].workItem=null,b.remove(c.name).then(function(){f()})},a.createWorkItem=function(){if(""===a.work.status&&(a.work.status=a.selectedCategory),a.update===!0){g(a.work);for(var c=document.getElementById("useritemUserSelection"),d=0;d<c.options.length;d++)c.options[d].selected===!0&&b.addToUser(a.work,a.users[d].userID);a.update=!1}else b.add(a.work).then(function(){for(var c=document.getElementById("useritemUserSelection"),d=0;d<c.options.length;d++)c.options[d].selected===!0&&b.addToUser(a.work,a.users[d].userID);a.workItems.push(a.work)})},a.sortableOptionsList={};for(var i=0;i<WorkItemCategories.length;i++)a.sortableOptionsList[WorkItemCategories[i]]=h(WorkItemCategories[i])}]);var WorkItemCategories=["Backlog","Current","Testing","Working"];angular.module("leanbitSupportTicketSystemApp").factory("workitemDb",["$http",function(a){var b="http://localhost:8080/ticketsystem/workitem";return a.defaults.headers.common["X-Requested-With"],{getAll:function(){return a.get(b+"/getall")},add:function(c){return a.post(b,c)},remove:function(c){return a["delete"](b+"/"+c)},update:function(c){return a.put(b,c)},addToUser:function(c,d){return a.put(b+"/addtouser/"+d,c)}}}]),angular.module("leanbitSupportTicketSystemApp").factory("usersDb",["$http",function(a){var b="http://localhost:8080/ticketsystem/user";return{getAll:function(){return a.get(b+"/team/leanbit")},update:function(c){return a.put(b,c)}}}]),angular.module("leanbitSupportTicketSystemApp").run(["$templateCache",function(a){a.put("views/main.html",'<div class="center-content font-pen"> <h1 class="center-text">Leanbit Ticket system</h1> <br> <div class="row" ng-controller="WorkitemCtrl"> <div ui-sortable> <div class="col-lg-3" ng-repeat="col in categories"> <h1 class="movable"> {{col}} <span class="glyphicon glyphicon-plus-sign clickable" ng-click="addNewWorkItemPopup(col)"></span> </h1> <div ui-sortable="sortableOptionsList[col]" id="{{col}}" class="apps-container"> <div id="{{$index}}" class="post-it-note" ng-repeat="workitem in workItems | filter:col:strict | orderBy: \'priority\'"> <br> <br> <div class="row"> <div class="col-lg-10"> <span class="glyphicon glyphicon-remove clickable" ng-click="deleteWorkItemButton({{workitem}})"></span> </div> <div class="col-lg-1"> <span class="glyphicon glyphicon-cog clickable" ng-click="modifyWorkItemPopup({{workitem}})"></span> </div> </div> <h2 class="inline">{{workitem.name}}</h2> <div class="row"> </div> <span class="center-text"> <span class="center-text" ng-repeat="user in getWorkitemUsers(workitem.name, users)"> {{user.userName}}: Authur<br> </span> <span class="center-text"> Prioritet: {{workitem.priority}} <br> <br> {{workitem.description}} </span> </span> </div> </div> </div> </div> <div id="popup" class="popup-content" ng-controller="WorkitemCtrl"> <div class="row"> <div class="col-lg-3"> <span class="clickable" ng-click="closeAddNewWorkItemPopup();">Close</span> </div> <div class="col-lg-8"> Add new work item </div> </div> <!-- Workitems input --> <form name="inputForm" class="center" role="form" ng-submit="createWorkItem();closeAddNewWorkItemPopup();"> <div class="row"> <div class="input-group col-xs-12"> <span class="input-group-addon form-text-description-size">Name</span> <input name="name" class="form-control" type="text" ng-model="work.name" placeholder="Name" id="workitemName" required> </div> </div> <div class="row"> <div class="input-group col-xs-12"> <span class="input-group-addon form-text-description-size">Descripton</span> <textarea name="description" class="form-control" rows="5" ng-model="work.description" id="workitemDescription" placeholder="Description" required>\n        </div>\n      </div>\n      <div class="row">\n        <div class="input-group col-xs-12">\n          <span class="input-group-addon form-text-description-size">Status</span>\n          <select type="text" ng-model="work.status" class="form-control" id="workitemStatusSelection">\n              <option ng-repeat="col in categories" value="{{col}}">{{col}}</option>\n          </select>\n        </div>\n      </div>\n      <div class="row">\n        <div class="input-group col-xs-12">\n          <span class="input-group-addon form-text-description-size">User</span>\n          <select type="text" ng-model="workitem.user" class="form-control" id="useritemUserSelection">\n              <option ng-repeat="user in users" value="{{user.userID}}" ng-model="work.user">{{user.firstName}} {{user.lastName}}</option>\n          </select>\n        </div>\n      </div>   \n      <div class="row">\n        <div class="input-group col-xs-12">\n          <span class="input-group-addon form-text-description-size">Priority</span>\n            <input name="priority" type="number" ng-model="work.priority" placeholder="from 0 to 10" class="form-control" min="0" max="10" id="workitemPriority" required>\n        </div>\n      </div> \n      <div class="row">\n        <div class="input-group col-xs-12">\n            <input type="submit" class="btn btn-primary fill-width" value="Save" ng-disabled="inputForm.$dirty && inputForm.$invalid"> \n        </div>\n      </div>\n      </form>\n    </div>\n</div></div>')}]);